<!DOCTYPE html>
<html >
  <head>
       <meta name="mobile-web-app-capable" content="yes">
    <meta charset="UTF-8">
        <title>On Cosmic Paw Tracks</title> 
   
        <link rel="stylesheet" type="text/css" href="styles.css">
  </head>

    
  <body class="fadeIn" onload="init()">
      <div id="sceneName" class="sceneName">
        7. On Cosmic Tracks
      </div>
    
      <div class="wrapper">
           <a class="prev" href="laika06.html"> < </a> 
            <a class="next" href="laika08.html"> > </a> 
    </div>
          <div style="width: 90%; display: inline-block; overflow: hidden;">  
      <div id="sky1" class="scene sky1" onclick="checkForNext()">
          <canvas id="can" width="1024" height="640">
          </canvas>
      
      </div>
          </div>
      <div id="sceneDescription" class="sceneDescription">
          Reached orbit. Please calibrate course coordinates. <p style="font-size: x-small;"> click/drag on image to draw </p>
      </div>
      
    <div id="restart" class="restart sceneName">
        <a href="">restart</a>
    </div>
      
<script src="laika.js"></script>
<script>
    
    
function requestFullScreen(element) {
    // Supports most browsers and their versions.
    var requestMethod = element.requestFullScreen || element.webkitRequestFullScreen || element.mozRequestFullScreen || element.msRequestFullscreen;

    if (requestMethod) { // Native full screen.
//        alert(requestMethod);
        requestMethod.call(element);
    } else if (typeof window.ActiveXObject !== "undefined") { // Older IE.
        var wscript = new ActiveXObject("WScript.Shell");
        if (wscript !== null) {
            wscript.SendKeys("{F11}");
        }
    }
    
    /// get computed style for image
//var img = document.getElementById('sky1');
//var cs = getComputedStyle(img);
//
///// these will return dimensions in *pixel* regardless of what
///// you originally specified for image:
//var width = parseInt(cs.getPropertyValue('width'), 10);
//var height = parseInt(cs.getPropertyValue('height'), 10);
///// now use this as width and height for your canvas element:
//var canvas = document.getElementById('can');
//
//canvas.width = width;
//canvas.height = height;
}
   
function checkForNext() {
    if (!document.webkitIsFullScreen) {
//        requestFullScreen(document.body);
//        requestFullScreen(document.getElementById('sky1'));
    }
}
</script>
      
 
<script type="text/javascript">
var canvas, ctx, flag = false,
    prevX = 0,
    currX = 0,
    prevY = 0,
    currY = 0,
    dot_flag = false;

var x = "rgba(255, 255, 255, 0.7)",
    y = 1.5;

function init() {
    canvas = document.getElementById('can');
    ctx = canvas.getContext("2d");
    w = canvas.width;
    h = canvas.height;

    canvas.addEventListener("mousemove", function (e) {
        findxy('move', e)
    }, false);
    canvas.addEventListener("mousedown", function (e) {
        findxy('down', e)
    }, false);
    canvas.addEventListener("mouseup", function (e) {
        findxy('up', e)
    }, false);
//    canvas.addEventListener("mouseout", function (e) {
//        findxy('out', e)
//    }, false);
    
    canvas.addEventListener("touchstart", function (e) {
        findxy('touchstart', e)
    }, false);
    canvas.addEventListener("touchmove", function (e) {
        findxy('touchmove', e)
    }, false);
    canvas.addEventListener("touchend", function (e) {
        findxy('touchend', e)
    }, false);
}


function draw() {
    ctx.beginPath();
    ctx.moveTo(prevX, prevY);
    ctx.lineTo(currX, currY);
    ctx.strokeStyle = x;
    ctx.lineWidth = y;
    ctx.stroke();
    ctx.closePath();
}

function findxy(res, e) {
    e.preventDefault();
    if (res == 'down' || res == 'touchstart') {
//        alert('down');
        prevX = currX;
        prevY = currY;
        currX = e.clientX - canvas.offsetLeft;
        currY = e.clientY - canvas.offsetTop;

        if (res == 'touchstart') {
            currX = e.changedTouches[0].pageX - canvas.offsetLeft;
            currY = e.changedTouches[0].pageY - canvas.offsetTop;
        }
        
        flag = true;
        dot_flag = true;
        if (dot_flag) {
//            ctx.beginPath();
//            ctx.fillStyle = x;
            
            mix = Math.round((Math.random() - 0.5) * 500);
            //alert(mix);
            newx = "rgba(" + (Math.round(Math.random() * 255) + mix) + "," + (Math.round(Math.random() * 255) + mix) + "," + (Math.round(Math.random() * 255) + mix) + "," + Math.round(Math.random() * 100) / 200 + ")";
            //alert(x);
           // y = Math.random() * 1.5;
            ctx.beginPath();
            ctx.fillStyle = newx;
            
            ctx.arc(currX, currY, Math.random() * 3 + 2, 0, 2 * Math.PI, false);
            ctx.fill();
            //ctx.fillRect(currX, currY, 10, 10);
            ctx.closePath();
            dot_flag = false;
        }
    }
    if (res == 'up' || res == 'touchend') {// || res == "out") {
//        alert('up');
        currX = e.clientX - canvas.offsetLeft;
        currY = e.clientY - canvas.offsetTop;
        
        if (res == 'touchend') {// || res == "out") {
            currX = e.changedTouches[0].pageX - canvas.offsetLeft;
            currY = e.changedTouches[0].pageY - canvas.offsetTop;
        }
        
        ctx.arc(currX, currY, 2, 0, 2 * Math.PI, false);
        ctx.fill();
        flag = false;
        draw();
        showRestart();
        document.getElementById('sky1').style.backgroundImage = "url(images/7_sky_1.gif)";
    }
    if (res == 'move' || res == 'touchmove') {
//        alert('move');
        if (flag) {
            prevX = currX;
            prevY = currY;
//            currX = e.clientX - canvas.offsetLeft;
//            currY = e.clientY - canvas.offsetTop;
            //draw();
        }
    }
}
</script>
      
  </body>
</html>
