<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
        <title>On Cosmic Paw Tracks</title> 
   
        <link rel="stylesheet" type="text/css" href="styles.css">
  </head>

    
  <body class="fadeIn" onload="init()">
      <div id="sceneName" class="sceneName">
        8. Moon dog
      </div>
    
      <div class="wrapper">
           <a class="prev" href="laika07.html"> < </a> 
         <a class="next" href="laika08b.html"> > </a> 
    </div>
         <div style="width: 90%; display: inline-block; overflow: hidden;">   
      <div id="moon" class="scene moon2">  
          <canvas id="can" width="1024" height="640" class="scene moon1">
              <img src="images/8_sky_1.gif" id="pattern" width="1024" height="640" style="visibility: hidden;">
          </canvas>
      
      </div>
          </div>
      <div id="sceneDescription" class="sceneDescription">
          Laika's course was towards the Moon, but she never arrived. Her body is still drifting aimlessly in outer space. See if you can find her tracks in the constellations around. <p style="font-size: x-small;"> click/drag mouse to reveal image </p>
      </div>
     
          <div id="restart" class="restart sceneName">
        <a href="">restart</a>
    </div>
      
<script src="laika.js"></script>    
<script>
function checkForNext() {
}
</script>
      
 
<script type="text/javascript">
var canvas, ctx, flag = false,
    prevX = 0,
    currX = 0,
    prevY = 0,
    currY = 0,
    dot_flag = false;

var x = "rgba(255, 255, 255, 0.7)",
    y = 10;

function init() {
    canvas = document.getElementById('can');
    ctx = canvas.getContext("2d");
    w = canvas.width;
    h = canvas.height;

    canvas.addEventListener("mousemove", function (e) {
        findxy('move', e)
    }, false);
    canvas.addEventListener("mousedown", function (e) {
        findxy('down', e)
    }, false);
    canvas.addEventListener("mouseup", function (e) {
        findxy('up', e)
    }, false);
    canvas.addEventListener("mouseout", function (e) {
        findxy('out', e)
    }, false);
    
     canvas.addEventListener("touchstart", function (e) {
        findxy('touchstart', e)
    }, false);
    canvas.addEventListener("touchmove", function (e) {
        findxy('touchmove', e)
    }, false);
    canvas.addEventListener("touchend", function (e) {
        findxy('touchend', e)
    }, false);
}

var counter = 0;
    
function draw() {
    ctx.beginPath();
    ctx.moveTo(prevX, prevY);
    ctx.lineTo(currX, currY);
    ctx.strokeStyle = x;
    ctx.lineWidth = y;
    ctx.stroke();
    ctx.closePath();
}

function findxy(res, e) {
    e.preventDefault();
    if (res == 'down' || res == 'touchstart') {
        prevX = currX;
        prevY = currY;
        currX = e.clientX - canvas.offsetLeft;
        currY = e.clientY - canvas.offsetTop;

        if (res == 'touchstart') {
            currX = e.changedTouches[0].pageX - canvas.offsetLeft;
            currY = e.changedTouches[0].pageY - canvas.offsetTop;
        }
        
        flag = true;
        dot_flag = true;
        if (dot_flag) {
            ctx.beginPath();
            var img=document.getElementById("pattern");
            var pat=ctx.createPattern(img,"repeat");
            //ctx.rect(0,0,150,100);
            ctx.arc(currX, currY, 0, 0, 2 * Math.PI, false);
            ctx.fillStyle=pat;
            ctx.fill();
//            ctx.fillStyle = x;
//            ctx.fillRect(currX, currY, 2, 2);
            //ctx.closePath();
            dot_flag = false;
        }
    }
    if (res == 'up' || res == "out" || res == "touchend") {
        flag = false;
        
        counter++;
        if (counter > 3) {
            //document.getElementById('moon').style.backgroundImage = "url(images/8_sky_1.gif)";
            document.getElementById('moon').style.webkitAnimationPlayState = "running";
            document.getElementById('can').style.animationPlayState = "running";
            showRestart();
        }
    }
    if (res == 'move' || res == 'touchmove') {
        if (flag) {
            prevX = currX;
            prevY = currY;
            currX = e.clientX - canvas.offsetLeft;
            currY = e.clientY - canvas.offsetTop;
            
            if (res == 'touchmove'){
                currX = e.changedTouches[0].pageX - canvas.offsetLeft;
                currY = e.changedTouches[0].pageY - canvas.offsetTop;
            }
            
            //draw();
            //ctx.rect(0,0,150,100);
            ctx.arc(currX, currY, 0, 0, 2 * Math.PI, false);
            ctx.fillStyle=pat;
            ctx.fill();
        }
    }
}
</script>
      
  </body>
</html>
